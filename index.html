<!DOCTYPE html>
<html>
<head>
<title>NOC Engineer Case Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: Arial; margin:0; background:#f4f6f9; display:flex; }
.sidebar{ width:270px; background:#1f2937; color:white; padding:20px; min-height:100vh; overflow-y:auto; }
.present-engineer{ background:rgba(255,255,255,0.1); padding:10px; margin-bottom:10px; border-radius:6px; font-size:14px; position:relative; }
.remove-btn{ position:absolute; right:8px; top:8px; background:red; color:white; border:none; padding:2px 6px; cursor:pointer; font-size:12px; }
.main{ flex:1; padding:20px; }
.dashboard{ display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:15px; }
.flip-card{ perspective:1000px; }
.flip-inner{ position:relative; width:100%; height:260px; transition:transform 0.6s; transform-style:preserve-3d; }
.flip-card:hover .flip-inner{ transform: rotateY(180deg); }
.flip-front, .flip-back{ position:absolute; width:100%; height:100%; backface-visibility:hidden; border-radius:10px; padding:15px; box-shadow:0 3px 8px rgba(0,0,0,0.1); background:white; }
.flip-back{ transform:rotateY(180deg); overflow-y:auto; }
.engineer-card.red .flip-front{ background:#ffdddd; border:2px solid red; }
.engineer-card.absent .flip-front{ background:#3a3a3a; color:#ccc; }
.engineer-card.next .flip-front{ border:3px solid #00c853; background:#e8f5e9; }
.badge{ position:absolute; top:10px; right:10px; background:red; color:white; padding:3px 6px; font-size:12px; border-radius:5px; }
.case{ background:#f0f0f0; margin:5px 0; padding:8px; border-radius:5px; font-size:14px; }
.delete-case{ background:red; color:white; border:none; padding:3px 6px; font-size:11px; cursor:pointer; margin-top:5px; }
</style>
</head>
<body>

<div class="sidebar">
<h2>Engineers Present Today</h2>
<select id="addPresentDropdown"></select>
<button onclick="addPresentEngineer()">Add</button>
<div id="presentList" style="margin-top:20px;"></div>
</div>

<div class="main">
<h1>Engineer Case Assignment Dashboard</h1>

<input type="text" id="caseId" placeholder="Case ID">
<select id="region">
<option>AMS</option>
<option>APJ</option>
<option>EMEA</option>
</select>
<select id="severity">
<option>SEV-1</option>
<option>SEV-2</option>
<option>SEV-3</option>
</select>
<select id="assignEngineer"></select>
<label>
<input type="checkbox" id="isCarCase"> CAR Case
</label>
<button onclick="addCase()">Assign Case</button>
<button onclick="resetAllData()">Reset All Data</button>

<div class="dashboard" id="dashboard"></div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, onValue } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  databaseURL: "YOUR_DATABASE_URL",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_STORAGE_BUCKET",
  messagingSenderId: "YOUR_MSG_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const masterEngineers = [

/* ================= L1 ENGINEERS ================= */

{ level:"L1", name:"Aaditya", shift:"5:30 AM - 2:30 PM", region:"APJ" },
{ level:"L1", name:"Rituja", shift:"5:30 AM - 2:30 PM", region:"APJ" },
{ level:"L1", name:"Aayush", shift:"5:30 AM - 2:30 PM", region:"APJ" },
{ level:"L1", name:"Namneet", shift:"5:30 AM - 2:30 PM", region:"APJ" },
{ level:"L1", name:"Devyani", shift:"5:30 AM - 2:30 PM", region:"APJ" },

{ level:"L1", name:"Ashish", shift:"11:00 AM - 8:00 PM", region:"APJ" },
{ level:"L1", name:"Tanisha N", shift:"11:00 AM - 8:00 PM", region:"APJ" },

{ level:"L1", name:"Avinash", shift:"1:30 PM - 10:30 PM", region:"EMEA" },
{ level:"L1", name:"Vrushali", shift:"1:30 PM - 10:30 PM", region:"EMEA" },
{ level:"L1", name:"Yashaswini", shift:"1:30 PM - 10:30 PM", region:"EMEA" },
{ level:"L1", name:"Avleen", shift:"3:00 PM - 12:00 AM", region:"EMEA" },

{ level:"L1", name:"Vansh", shift:"1:30 PM - 10:30 PM", region:"AMS" },

{ level:"L1", name:"Mayank", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L1", name:"Sakshi", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L1", name:"Swarupa", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L1", name:"Prabhnoor", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L1", name:"Shafiya", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L1", name:"Shefali", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L1", name:"Navya", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L1", name:"Akshay", shift:"5:00 PM - 2:00 AM", region:"AMS" },

{ level:"L1", name:"Sufiyan", shift:"9:00 PM - 6:00 AM", region:"AMS" },
{ level:"L1", name:"Afsan", shift:"9:00 PM - 6:00 AM", region:"AMS" },
{ level:"L1", name:"Abhilash", shift:"9:00 PM - 6:00 AM", region:"AMS" },
{ level:"L1", name:"Rudrani", shift:"9:00 PM - 6:00 AM", region:"AMS" },
{ level:"L1", name:"Anubhav", shift:"9:00 PM - 6:00 AM", region:"AMS" },
{ level:"L1", name:"Tanisha K", shift:"9:00 PM - 6:00 AM", region:"AMS" },
{ level:"L1", name:"Suraj", shift:"9:00 PM - 6:00 AM", region:"AMS" },

/* ================= L2 ENGINEERS ================= */

{ level:"L2", name:"Prasenjit", shift:"1:30 PM - 10:30 PM", region:"AMS" },
{ level:"L2", name:"Isha", shift:"5:00 PM - 2:00 AM", region:"AMS" },
{ level:"L2", name:"Keith", shift:"9:00 PM - 6:00 AM", region:"AMS" }

];

let presentEngineers = [];
let cases = [];

function saveData(){
    set(ref(db,"dashboardData"),{
        presentEngineers,
        cases
    });
}

onValue(ref(db,"dashboardData"), snapshot=>{
    const data = snapshot.val();
    if(data){
        presentEngineers = data.presentEngineers || [];
        cases = data.cases || [];
        render();
    }
});

function addPresentEngineer(){
    const name=document.getElementById("addPresentDropdown").value;
    if(name && !presentEngineers.includes(name)){
        presentEngineers.push(name);
        saveData();
    }
}

function addCase(){
    const caseId=document.getElementById("caseId").value;
    const region=document.getElementById("region").value;
    const severity=document.getElementById("severity").value;
    const engineer=document.getElementById("assignEngineer").value;
    const isCar=document.getElementById("isCarCase").checked;

    if(!caseId || !engineer) return alert("Enter Case ID & Engineer");

    cases.push({
        caseId,
        region,
        severity,
        engineer,
        isCar,
        time:new Date().toLocaleString()
    });

    saveData();
}

function deleteCase(caseId){
    cases = cases.filter(c=>c.caseId!==caseId);
    saveData();
}

function resetAllData(){
    if(confirm("Reset ALL data?")){
        presentEngineers=[];
        cases=[];
        saveData();
    }
}

function render(){

    const dashboard=document.getElementById("dashboard");
    const presentList=document.getElementById("presentList");
    const assignDD=document.getElementById("assignEngineer");
    const presentDD=document.getElementById("addPresentDropdown");

    dashboard.innerHTML="";
    presentList.innerHTML="";
    assignDD.innerHTML="";
    presentDD.innerHTML="<option value=''>Select Engineer</option>";

    masterEngineers.forEach(e=>{
        presentDD.innerHTML+=`<option value="${e.name}">${e.name}</option>`;
        if(presentEngineers.includes(e.name)){
            assignDD.innerHTML+=`<option value="${e.name}">${e.name}</option>`;
            presentList.innerHTML+=`<div class="present-engineer">${e.name}</div>`;
        }
    });

    masterEngineers.forEach(e=>{
        const engCases=cases.filter(c=>c.engineer===e.name);
        const hasSev1=engCases.some(c=>c.severity==="SEV-1");

        let cardClass="engineer-card";
        if(!presentEngineers.includes(e.name)) cardClass+=" absent";
        if(hasSev1) cardClass+=" red";

        dashboard.innerHTML+=`
        <div class="flip-card ${cardClass}">
            <div class="flip-inner">
                <div class="flip-front">
                    ${hasSev1?'<div class="badge">SEV-1 ACTIVE</div>':''}
                    <h3>${e.name}</h3>
                    <p>Active Cases: ${engCases.length}</p>
                </div>
                <div class="flip-back">
                    ${engCases.length===0?"No cases":""}
                    ${engCases.map(c=>`
                        <div class="case">
                            <strong>${c.caseId}</strong><br>
                            ${c.region} | ${c.severity}
                            ${c.isCar?'<span style="color:orange;"> (CAR)</span>':''}
                            <br><button class="delete-case" onclick="deleteCase('${c.caseId}')">Remove</button>
                        </div>
                    `).join("")}
                </div>
            </div>
        </div>
        `;
    });
}

render();

</script>
</body>
</html>
